<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reddit Bot Config</title>
    <script src="https://kit.fontawesome.com/1ad022fbba.js" crossorigin="anonymous"></script>
    <link ref="stylesheet" href="./src/style.css">
</head>
<body>
    <div class="modal-ctr">
    <button id="modalBtn">Instructions</button></div>
        <div id="modal-div"></div><!-- The Modal -->
<div id="myModal" class="modal">
<!-- Modal content -->
<div class="modal-content">
    <div class="modal-header">
<span class="close">&times;</span>
<h2>How to Create an App in Reddit</h2>
    </div>
    <div class="modal-body">
<ol>
        <li>Go to <a href="https://devvit.com" target="_blank">https://devvit.com</a></li>
        <li>Log in or Sign Up if you don't have an account</li>
        <li>Go to <a href="https://reddit.com/prefs/apps" target="_blank">https://reddit.com/prefs/apps</a></li>
        <li>Click 'Create another app'</li>
        <li>Enter app name</li>
        <li>Select 'Script'</li>
        <li>Enter description</li>
        <li>For 'redirect uri', enter 'https://localhost:8080'</li>
        <li>Check the box for 'I'm not a robot'</li>
        <li>Get the Client ID which is underneath the app name in the upper left-hand corner labeled 'personal use script'</li>
        <li>Get the secret from the form (first field on left)</li>
</ol>
    </div>
    <div class="modal-footer">
<h2>&nbsp;</h2>
    </div>
</div>
</div>
</div>
<div class="container">
    <h1>Reddit Bot<br>Code Generator</h1>
    <form id="botForm">
<legend><span class="number">1</span> User Credentials</legend>
<label>Username</label>
<input type="text" name="username" required placeholder="Reddit Username">

<label>Password</label>
<input type="password" name="password" required placeholder="Reddit Password" id="myInput"><i id="icon" class="fa" onclick="showPassword()">&#xf070;</i>
        
<legend><span class="number">2</span> Agent Information </legend>
<label>User Agent</label>
<input type="text" name="userAgent" required placeholder="User Agent">

<label>Client ID</label>
<input type="text" name="clientId" required placeholder="Client ID">

<label>Secret</label>
<input type="text" name="secret" required placeholder="Secret">

<label>Subreddits <span class="subtext">(comma separated)</span></label>
<input type="text" name="subreddits" required placeholder="news,pics,funny">

<label>Keywords <span class="subtext">(comma separated)</span></label>
<input type="text" name="keywords" required placeholder="keyword1,keyword2">

<label>Content</label>
<textarea name="content" rows="4" required placeholder="Enter text exactly as you want it to appear on-screen"></textarea>

<button type="button" id="submitBtn">Submit</button>
    </form>
<code>
    <pre id="codeBlock"></pre>
</code>
</div>
    <script>
function showPassword() {
  var x = document.getElementById("myInput");
  if (x.type === "password") {
    x.type = "text";
  } else {
    x.type = "password";
  }
}
</script>
<script>
    const form = document.getElementById("botForm");
    const submitBtn = document.getElementById("submitBtn");
    const codeBlock = document.getElementById("codeBlock");

    let step = 1;

submitBtn.addEventListener("click", () => {
    if (step === 1) {
        submitBtn.textContent = "Confirm Values";
        step = 2;
    } else {
        const formData = Object.fromEntries(new FormData(form).entries());
        document.getElementById("submitBtn").style.display = "none";

        // Save to localStorage
        localStorage.setItem("redditBotConfig", JSON.stringify(formData));

        // Process subreddits & keywords
        const subs = formData.subreddits.split(",").map(s => s.trim()).filter(Boolean);
        const keywords = formData.keywords.split(",").map(k => `'${k.trim()}'`).filter(Boolean);

        // Build template
        const template = `
userAgent = '${formData.userAgent}'
clientId = '${formData.clientId}'
secret = '${formData.secret}'
username = '${formData.username}'
password = '${formData.password}'

reddit = praw.Reddit(
    user_agent=userAgent,
    client_id=clientId,
    client_secret=secret,
    username=username,
    password=password,
)

subreddits = ["${subs.join('", "')}"]

content = """${formData.content}"""

keywords = {${keywords.join(", ")}}

resultsCount = 0

for sub in subreddits:
    subreddit = reddit.subreddit(sub)
    # Check posts
    for submission in subreddit.hot(limit=20):
        text = (submission.title + " " + submission.selftext).lower()
        if any(keyword.lower() in text for keyword in keywords):
            if submission.author and submission.author.name.lower() == username.lower():
                continue
            print("Bot replying to post: ")
            print("Title: ", submission.title)
            print("Text: ", submission.selftext)
            print("----------------------------")
            print(content, "This was generated by a bot!")
            print()
            try:
                submission.reply(content)
                resultsCount += 1
                sleep(60)
            except Exception as e:
                print("Error replying to post: ", e)
        # Check comments
        submission.comments.replace_more(limit=0)
        for comment in submission.comments.list():
            if any(keyword.lower() in comment.body.lower() for keyword in keywords):
                print("Bot replying to comment: ")
                print("Comment: ", comment.body)
                print("----------------------------")
                try:
                    comment.reply(content)
                    resultsCount += 1
                    sleep(120)
                except Exception as e:
                    print("Error replying to comment: ", e)

if resultsCount == 0:
    print()
    print("Sorry. I didn't find any posts or comments with those keywords.")
        `;

        // Show code
        codeBlock.style.display = "block";
        codeBlock.textContent = template;
}
    });
</script>

<script>
// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("modalBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
btn.onclick = function() {
modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
if (event.target == modal) {
    modal.style.display = "none";
}
}
</script>
</body>
</html>


